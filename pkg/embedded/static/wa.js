(function(){var v,h=document.currentScript,t=location,n=h.dataset,w=new URL(h.src),l="no-referrer-when-downgrade",o="POST",_=t.protocol,r=n.prismeUrl||w.origin,f=n.domain||t.host,j=n.path||t.pathname,i=!!n.manual&&n.manual!=="false"||!1,b=n.visitorId,u=n.outboundLinks!=="false",d=document.referrer.replace(t.host,f),m=1,e=globalThis,y="Request"in e&&"keepalive"in new Request("");function c(e){return e||(e={}),e.domain||(i?e.domain=t.host:e.domain=f),e.path||(i||m>1?e.path=t.pathname:e.path=j),e.visitorId||(e.visitorId=b),e.url=_.concat("//",e.domain,e.path,t.search),e}function a(e,t){return t["Access-Control-Max-Age"]=3600,t["X-Prisme-Referrer"]=e.url,e.visitorId&&(t["X-Prisme-Visitor-Id"]=e.visitorId.toString()),t}function s(e){e=c(e),fetch(r.concat("/api/v1/events/pageviews"),{method:o,headers:a(e,{"X-Prisme-Document-Referrer":d}),keepalive:!0,referrerPolicy:l}),d=e.url,m++}function p(e){return e=c(e),fetch(r.concat("/api/v1/events/clicks"),{method:o,headers:a(e,{"Content-Type":"application/json"}),keepalive:!0,referrerPolicy:l,body:JSON.stringify({tag:e.tag,attr:e.attr})})}function g(n){if(n.type==="auxclick"&&n.button!==1||!(n.target instanceof Element))return;var s,o,i,a=n.target.closest("a");if(!a)return;s=new URL(a.href||"",t.origin),u&&s.host!==t.host&&(o=!1,i=()=>{o||(o=!0,e.location.assign(s))},y||(n.preventDefault(),setTimeout(i,5e3)),p({tag:"a",attr:s}).finally(i))}u&&(document.addEventListener("click",g),document.addEventListener("auxclick",g)),e.prisme={pageview:s,trigger(e,t,n){n=c(n),fetch(r.concat("/api/v1/events/custom/",e),{method:o,headers:a(n,{"Content-Type":"application/json"}),keepalive:!0,referrerPolicy:l,body:JSON.stringify(t)})},click:p},i||(delete e.prisme.pageview,s(),e.history&&(v=e.history.pushState,e.history.pushState=function(){v.apply(e.history,arguments),s()},e.addEventListener("popstate",s)))})()