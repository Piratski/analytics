(function(){var g,d=document.currentScript,e=location,t=d.dataset,y=new URL(d.src),c="no-referrer-when-downgrade",i="POST",j=e.protocol,r=t.prismeUrl||y.origin,l=t.domain||e.host,b=t.path||e.pathname,s=!!t.manual&&t.manual!=="false"||!1,v=t.visitorId,u=t.outboundLinks!=="false",h=document.referrer.replace(e.host,l),m=1;function o(t){return t||(t={}),t.domain||(s?t.domain=e.host:t.domain=l),t.path||(s||m>1?t.path=e.pathname:t.path=b),t.visitorId||(t.visitorId=v),t.url=j.concat("//",t.domain,t.path,e.search),t}function a(e,t){return t["Access-Control-Max-Age"]=3600,t["X-Prisme-Referrer"]=e.url,e.visitorId&&(t["X-Prisme-Visitor-Id"]=e.visitorId.toString()),t}function n(e){e=o(e),fetch(r.concat("/api/v1/events/pageviews"),{method:i,headers:a(e,{"X-Prisme-Document-Referrer":h}),keepalive:!0,referrerPolicy:c}),h=e.url,m++}function f(e){e=o(e),fetch(r.concat("/api/v1/events/clicks"),{method:i,headers:a(e,{"Content-Type":"application/json"}),keepalive:!0,referrerPolicy:c,body:JSON.stringify({tag:e.tag,id:e.id})})}function p(e){if(e.type==="auxclick"&&e.button!==1||!(e.target instanceof Element))return;const t=e.target.closest("a"),n=t&&t.href&&t.href.split("?")[0];u&&f({tag:"a",id:n})}u&&(document.addEventListener("click",p),document.addEventListener("auxclick",p)),window.prisme={pageview:n,trigger(e,t,n){n=o(n),fetch(r.concat("/api/v1/events/custom/",e),{method:i,headers:a(n,{"Content-Type":"application/json"}),keepalive:!0,referrerPolicy:c,body:JSON.stringify(t)})},click:f},s||(delete window.prisme.pageview,n(),window.history&&(g=window.history.pushState,window.history.pushState=function(){g.apply(window.history,arguments),n()},window.addEventListener("popstate",n)))})()